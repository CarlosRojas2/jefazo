[build]
builder = "railpack"

# Extensiones PHP
[build.php]
extensions = ["bcmath"]

# Node para compilar Vite
[build.node]
version = "18"
packageManager = "pnpm"

# Comandos de compilación
[build.commands]
php = "composer install --no-dev --optimize-autoloader"
node = "pnpm install --frozen-lockfile && pnpm run build"

[deploy]
# Caddy + PHP-FPM ya sirven el sitio automáticamente
startCommand = "php artisan migrate --force"
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 10
